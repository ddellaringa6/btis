<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bitcoin Top Indicator Score (BTIS)</title>
  <style>
    :root {
      --bg: #0b0f1a;
      --card: #12182a;
      --accent: #39d98a;
      --accent2: #6ea8fe;
      --text: #e6ecff;
      --muted: #9fb0d1;
      --danger: #ff6b6b;
      --warn: #f6c343;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; background: radial-gradient(1200px 800px at 80% -20%, #19213b 0%, var(--bg) 40%) no-repeat, var(--bg);
      color: var(--text); font: 16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      display: flex; min-height: 100vh; align-items: center; justify-content: center; padding: 24px;
    }
    .wrap { width: 100%; max-width: 900px; }
    header { display: flex; align-items: center; justify-content: space-between; gap: 16px; margin-bottom: 20px; }
    h1 { font-size: 1.6rem; margin: 0; letter-spacing: .2px; }
    .pill { padding: 6px 10px; border-radius: 999px; background: #0f1630; color: var(--muted); font-weight: 600; border: 1px solid #1a2447; }
    .grid { display: grid; grid-template-columns: 1.2fr .8fr; gap: 16px; }
    .card { background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.12)), var(--card); border: 1px solid #1a2447; border-radius: 14px; padding: 18px; }
    .score { display: grid; grid-template-columns: 1fr 1fr; gap: 18px; align-items: center; }
    .big { text-align: center; padding: 24px 12px; border-radius: 12px; background: #0f1630; border: 1px solid #1a2447; }
    .big h2 { font-size: 3.5rem; margin: 6px 0 4px; line-height: 1; }
    .big small { color: var(--muted); }
    .meter { height: 16px; border-radius: 999px; background: #0e142a; border: 1px solid #1a2447; overflow: hidden; }
    .bar { height: 100%; width: 0%; background: linear-gradient(90deg, var(--danger), var(--warn), var(--accent)); transition: width .8s ease; }
    .kvs { display: grid; grid-template-columns: repeat(2,1fr); gap: 10px; }
    .kv { display: grid; grid-template-columns: auto 1fr auto; gap: 10px; align-items: center; padding: 10px 12px; border-radius: 10px; background: #0f1630; border: 1px solid #1a2447; }
    .kv b { color: var(--muted); font-weight: 600; }
    .kv span { justify-self: end; font-variant-numeric: tabular-nums; font-weight: 700; }
    footer { margin-top: 18px; color: var(--muted); font-size: .9rem; display: flex; justify-content: space-between; gap: 12px; flex-wrap: wrap;}
    a { color: var(--accent2); text-decoration: none; }
    .legend { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
    .dot { width: 10px; height: 10px; border-radius: 50%; background: var(--accent); border: 1px solid #1a2447; }
    @media (max-width: 820px){
      .grid { grid-template-columns: 1fr; }
      .score { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Bitcoin Top Indicator Score (BTIS)</h1>
      <span class="pill" id="last-updated">—</span>
    </header>
    <div class="grid">
      <section class="card">
        <div class="score">
          <div class="big">
            <div>BTIS</div>
            <h2 id="btis">—</h2>
            <small id="risk">Calculating…</small>
          </div>
          <div>
            <div class="meter"><div id="meter" class="bar"></div></div>
            <div class="legend" style="margin-top:8px;">
              <span class="dot" style="background:#ff6b6b"></span><small>0–39 Low Top Risk</small>
              <span class="dot" style="background:#f6c343"></span><small>40–69 Moderate</small>
              <span class="dot" style="background:#39d98a"></span><small>70–100 High Top Risk</small>
            </div>
          </div>
        </div>
      </section>
      <aside class="card">
        <div class="kvs" id="components"></div>
      </aside>
    </div>
    <footer>
      <div>Data sources: CoinGecko, Alternative.me, Binance Futures, Glassnode (optional)</div>
      <div>Open-source on GitHub • Auto-updates daily</div>
    </footer>
  </div>
<script>
async function loadBTIS(){
  const res = await fetch('data/btis.json?_=' + Date.now());
  const data = await res.json();
  const score = Math.round(data.btis);
  document.getElementById('btis').textContent = score;
  document.getElementById('last-updated').textContent = 'Updated ' + new Date(data.generated_at).toLocaleString();
  const meter = document.getElementById('meter');
  meter.style.width = score + '%';
  const risk = document.getElementById('risk');
  if(score >= 70) risk.textContent = 'High top risk (overheated)';
  else if(score >= 40) risk.textContent = 'Moderate caution';
  else risk.textContent = 'Low top risk';
  // components
  const c = document.getElementById('components');
  c.innerHTML = '';
  for (const row of data.components){
    const el = document.createElement('div');
    el.className = 'kv';
    el.innerHTML = `<b>${row.name}</b><div>${row.detail}</div><span>${row.normalized.toFixed(0)}</span>`;
    c.appendChild(el);
  }
}
loadBTIS();
</script>
</body>
</html>
